{"version":3,"sources":["intersectionObserver.js","services/http-util.js","components/IdentifierList/IdentifierList.js","ImageRenderer.js","services/archive-helper.js","components/ImageLoader/ImageLoader.js","components/Home/Home.js","App.js","index.js"],"names":["observer","HttpUtil","getImagesData","url","a","axios","get","response","data","getIdentifierData","docs","map","x","identifier","IdentifierList","onChange","loadFirstSite","useState","list","setList","useEffect","then","className","value","listenerCallbacks","WeakMap","handleIntersections","entries","forEach","entry","has","target","cb","isIntersecting","intersectionRatio","unobserve","delete","getIntersectionObserver","undefined","IntersectionObserver","rootMargin","threshold","ImageRenderer","elem","callback","thumb","width","height","isLoaded","setIsLoaded","isInView","setIsInView","imgRef","useRef","current","set","observe","ref","style","paddingBottom","minHeight","href","rel","classnames","src","onLoad","ArchiveHelper","getArchiveUrl","itemId","parseArchiveData","files","metadata","server","dir","sourceFiles","filter","source","thumbs","format","getIdentifierCreator","creator","ImageLoader","selectedIdentifier","setData","imageFiles","setImageFiles","getData","sourceData","imgArray","imgs","img","name","console","log","ITEM_LIST","Home","selectedList","setSelectedList","ev","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.6da63312.chunk.js","sourcesContent":["import { useEffect } from 'react';\n\nlet listenerCallbacks = new WeakMap();\n\nlet observer;\n\nfunction handleIntersections(entries) {\n  entries.forEach(entry => {\n    if (listenerCallbacks.has(entry.target)) {\n      let cb = listenerCallbacks.get(entry.target);\n\n      if (entry.isIntersecting || entry.intersectionRatio > 0) {\n        observer.unobserve(entry.target);\n        listenerCallbacks.delete(entry.target);\n        cb();\n      }\n    }\n  });\n}\n\nfunction getIntersectionObserver() {\n  if (observer === undefined) {\n    observer = new IntersectionObserver(handleIntersections, {\n      rootMargin: '100px',\n      threshold: '0.15'\n    });\n  }\n  return observer;\n}\n\nexport function useIntersection(elem, callback) {\n  useEffect(() => {\n    let target = elem.current;\n    let observer = getIntersectionObserver();\n    listenerCallbacks.set(target, callback);\n    observer.observe(target);\n\n    return () => {\n      listenerCallbacks.delete(target);\n      observer.unobserve(target);\n    };\n  }, []);\n}\n","import axios from 'axios';\n\nconst parseImages = (data) => {\n\n}   \n\nconst getImagesData = async (url) => {\n    const response = await axios.get(url);\n    const data = await response.data;\n    return data;\n}\n\nconst getIdentifierData = async () => {\n    let url = `https://archive.org/advancedsearch.php?q=creator%3Apix0x&fl%5B%5D=identifier&sort%5B%5D=publicdate+desc&sort%5B%5D=&sort%5B%5D=&rows=50&page=1&output=json&save=yes`;\n    const response = await axios.get(url);\n    const data = await response.data;\n    return data.response.docs.map(x => x.identifier);\n}\n\n\n\nconst HttpUtil = {\n    getImagesData,\n    getIdentifierData\n}\n\nexport default HttpUtil;","import React, { useEffect, useState } from 'react';\nimport HttpUtil from '../../services/http-util';\n\nconst IdentifierList = ({onChange, loadFirstSite}) => {\n\n    const [data, setData] = useState(null);\n    const [list, setList] = useState(null);\n\n\n\n    useEffect(() => {\n        HttpUtil.getIdentifierData().then(data => {\n            setList(data);\n            loadFirstSite(data);\n        })\n    }, [])\n\n    return (\n        <select onChange={onChange} className=\"custom-select custom-select-lg\">\n            {list && list.map(x => <option value={x}>{x}</option>)}\n        </select>\n    )\n}\n\nexport default IdentifierList;","import React, { useState, useRef } from 'react';\nimport classnames from 'classnames';\nimport { useIntersection } from './intersectionObserver';\nimport './imageRenderer.scss';\n\nconst ImageRenderer = ({ url, thumb, width, height }) => {\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [isInView, setIsInView] = useState(false);\n  const imgRef = useRef();\n  useIntersection(imgRef, () => {\n    setIsInView(true);\n  });\n\n  const handleOnLoad = () => {\n    setIsLoaded(true);\n  };\n  return (\n    <div\n      className=\"image-container\"\n      ref={imgRef}\n      style={{\n        paddingBottom: `10px`,\n        minHeight: '240px'       \n      }}\n    >\n      {isInView && (\n        <>\n        <a href={url} target={\"_blank\"} rel=\"noopener noreferrer\" >\n          <img\n            className={classnames('image', 'thumb', {\n              ['isLoaded']: !!isLoaded\n            })}\n            src={thumb}\n          />\n          <img\n            className={classnames('image', {\n              ['isLoaded']: !!isLoaded\n            })}\n            src={thumb}\n            onLoad={handleOnLoad}\n          />\n          </a>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default ImageRenderer;\n","\nconst getArchiveUrl = (itemId) => {\n    return `https://archive.org/metadata/${itemId}`\n}\n\nconst getIdentifierCreator = (creator) => {\n    return `https://archive.org/advancedsearch.php?q=creator%3Apix0x&fl%5B%5D=identifier&sort%5B%5D=publicdate+desc&sort%5B%5D=&sort%5B%5D=&rows=50&page=1&output=json&callback=callback&save=yes`;\n}\n\nconst parseArchiveData = (data) => {\n    if(!data) return null;\n    const {files, metadata, server, dir} = data;\n    const sourceFiles = files.filter(x => x.source == \"original\");\n    const thumbs = files.map(x => x.source === \"derivative\" && x.format === \"Thumbnail\");\n    return {\n        metadata,\n        sourceFiles,\n        thumbs,\n        server, \n        dir\n    }\n}\n\nconst ArchiveHelper = {\n    getArchiveUrl,\n    parseArchiveData,\n    getIdentifierCreator\n}\n\nexport default ArchiveHelper;","import React, { useEffect, useState } from 'react';\nimport ImageRenderer from '../../ImageRenderer';\nimport ArchiveHelper from \"../../services/archive-helper\";\nimport HttpUtil from \"../../services/http-util\";\n\n\n\n\n\n\nconst ImageLoader = ({selectedIdentifier}) => {\n    const [data, setData] = useState(null);\n    const [images, setImages] = useState(null);\n    const [imageFiles, setImageFiles] = useState(null);\n\n    const getData = async () => {\n        const itemId = selectedIdentifier;\n        const url  = ArchiveHelper.getArchiveUrl(itemId);\n        const data = await HttpUtil.getImagesData(url);\n        const sourceData = ArchiveHelper.parseArchiveData(data);\n        \n        const {sourceFiles, dir, server} = sourceData;\n        let imgArray = sourceFiles.filter(x => x.format == \"JPEG\");\n        let imgs = imgArray.map(x => ({\n            img: `https://i0.wp.com/${server}/${dir}/${x.name}`,\n            thumb: `https://i0.wp.com/${server}/${dir}/${x.name}?w=320`\n        }));\n        console.log(imgs);\n        setImageFiles(imgs);\n        //console.log(images);\n        console.log(sourceFiles);\n\n        setData(data);\n    }\n\n    useEffect(() => {\n        getData();\n    }, [selectedIdentifier]);\n\n    return imageFiles && imageFiles.map(x => <div>\n        <ImageRenderer\n        key={x.img}\n        url={x.img}\n        thumb={x.thumb}\n        width={640}\n        height={480}\n      />\n    </div>)\n        \n    ;\n}\n\nexport default ImageLoader;","import React, { useEffect, useState } from 'react';\nimport IdentifierList from '../IdentifierList/IdentifierList';\nimport ImageLoader from '../ImageLoader/ImageLoader';\n\nconst ITEM_LIST = [\n    'pix0x-57d723e9',\n    'pix0x-257ae802',\n    '2021-8-16-pix0x-d84c36573d37'\n]\nconst Home = () => {\n\n  const [selectedList, setSelectedList ] = useState(ITEM_LIST[0]);\n\n  const onSelectedListChange = (ev) => {\n    console.log(ev.target.value)\n    setSelectedList(ev.target.value);\n  }\n\n  const loadFirstSite = (data) => {\n    setSelectedList(data[0]);\n  }\n\n  return (\n    <section>\n      <IdentifierList onChange={onSelectedListChange} loadFirstSite={loadFirstSite} />\n      <div className=\"ImageGallery\">\n        <ImageLoader selectedIdentifier={selectedList} />\n      </div>\n    </section>\n  );\n};\n\n\nexport default Home;","import React from 'react';\nimport Home from './components/Home/Home';\nimport './App.scss'\nimport imageData from './imageData';\nimport ImageRenderer from './ImageRenderer';\n\nimport './style.css';\n\nexport default function App() {\n  return (\n    <div>\n      <h1>Lazy Load Images</h1>\n      <Home />\n    </div>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}