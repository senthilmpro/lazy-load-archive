(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{48:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var r,a=n(2),c=n(24),o=n.n(c),i=n(5),s=n(3),u=n.n(s),l=n(6),f=n(7),d=n.n(f),p={getImagesData:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.get(t);case 2:return n=e.sent,e.next=5,n.data;case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getIdentifierData:function(){var e=Object(l.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://archive.org/advancedsearch.php?q=creator%3Apix0x&fl%5B%5D=identifier&sort%5B%5D=publicdate+desc&sort%5B%5D=&sort%5B%5D=&rows=50&page=1&output=json&save=yes",e.next=3,d.a.get("https://archive.org/advancedsearch.php?q=creator%3Apix0x&fl%5B%5D=identifier&sort%5B%5D=publicdate+desc&sort%5B%5D=&sort%5B%5D=&rows=50&page=1&output=json&save=yes");case 3:return t=e.sent,e.next=6,t.data;case 6:return n=e.sent,e.abrupt("return",n.response.docs.map((function(e){return e.identifier})));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},h=n(0),b=function(e){var t=e.onChange,n=e.loadFirstSite,r=Object(a.useState)(null),c=Object(i.a)(r,2),o=(c[0],c[1],Object(a.useState)(null)),s=Object(i.a)(o,2),u=s[0],l=s[1];return Object(a.useEffect)((function(){p.getIdentifierData().then((function(e){l(e),n(e)}))}),[]),Object(h.jsx)("select",{onChange:t,className:"custom-select custom-select-lg",children:u&&u.map((function(e){return Object(h.jsx)("option",{value:e,children:e})}))})},j=n(13),m=n(14),g=n.n(m),v=new WeakMap;function O(e){e.forEach((function(e){if(v.has(e.target)){var t=v.get(e.target);(e.isIntersecting||e.intersectionRatio>0)&&(r.unobserve(e.target),v.delete(e.target),t())}}))}function x(){return void 0===r&&(r=new IntersectionObserver(O,{rootMargin:"100px",threshold:"0.15"})),r}n(48);var w=n(9),y=n(10),D=function(e){var t,n,r=e.url,c=e.thumb,o=(e.width,e.height,e.onImgError,e.original),s=Object(a.useState)(!1),f=Object(i.a)(s,2),p=f[0],b=f[1],m=Object(a.useState)(!1),O=Object(i.a)(m,2),D=O[0],k=O[1],I=Object(a.useState)("inherit"),B=Object(i.a)(I,2),E=B[0],C=B[1],L=Object(a.useRef)();t=L,n=function(){k(!0)},Object(a.useEffect)((function(){var e=t.current,r=x();return v.set(e,n),r.observe(e),function(){v.delete(e),r.unobserve(e)}}),[]);var S=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),r="[IMG]".concat(n,"[/IMG]"),a=document.createElement("textarea"),document.body.appendChild(a),a.value=r,a.select(),document.execCommand("copy"),document.body.removeChild(a);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=function(e,t){var n=this,r=document.createElement("a");r.href=e,r.download=t||"download";return r.addEventListener("click",(function t(r){URL.revokeObjectURL(e),n.removeEventListener("click",t)}),!1),r.click(),r},t.preventDefault(),console.log("origina ",n),r=n.split("/").pop(),a(n,r);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,a,c,o,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(e,t){c.onload=function(){o.width=this.naturalWidth,o.height=this.naturalHeight,i.drawImage(this,0,0),o.toBlob((function(e){t(e)}),"image/png")},c.src=e,console.log(c)},a=function(){return(a=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.a.get(t,{responseType:"arraybuffer"}).then((function(e){return e.data})).then((function(e){return new Blob([e])})).then((function(e){return URL.createObjectURL(e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},r=function(e){return a.apply(this,arguments)},t.preventDefault(),c=new Image,o=document.createElement("canvas"),i=o.getContext("2d"),e.next=9,r(n).then((function(e){s(e,(function(e){console.log("doing it!"),navigator.clipboard.write([new ClipboardItem({"image/png":e})]).then((function(e){console.log("Image copied to clipboard")})).catch((function(e){console.log(e)}))}))}));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"image-container",ref:L,style:{paddingBottom:"10px",minHeight:"240px",display:E},children:D&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:[Object(h.jsx)("img",{className:g()("image","thumb",Object(j.a)({},"isLoaded",!!p)),src:c}),Object(h.jsx)("img",{className:g()("image",Object(j.a)({},"isLoaded",!!p)),src:c,onLoad:function(){b(!0)},onError:function(){C("none")}})]}),Object(h.jsxs)("div",{className:"button-list",children:[Object(h.jsx)("button",{onClick:function(e){return A(e,r)},className:"btn-standard",children:Object(h.jsx)(w.a,{icon:y.a})}),Object(h.jsx)("button",{onClick:function(e){return N(e,o)},className:"btn-standard",children:Object(h.jsx)(w.a,{icon:y.b})}),Object(h.jsx)("button",{onClick:function(e){return S(e,r)},className:"btn-standard",children:Object(h.jsx)(w.a,{icon:y.c})})]})]})})},k={getArchiveUrl:function(e){return"https://archive.org/metadata/".concat(e)},parseArchiveData:function(e){if(!e)return null;var t=e.files,n=e.metadata,r=e.server,a=e.dir;return{metadata:n,sourceFiles:t.filter((function(e){return"original"==e.source})),thumbs:t.map((function(e){return"derivative"===e.source&&"Thumbnail"===e.format})),server:r,dir:a}},getIdentifierCreator:function(e){return"https://archive.org/advancedsearch.php?q=creator%3Apix0x&fl%5B%5D=identifier&sort%5B%5D=publicdate+desc&sort%5B%5D=&sort%5B%5D=&rows=50&page=1&output=json&callback=callback&save=yes"}},I=function(e){var t=e.selectedIdentifier,n=Object(a.useState)(null),r=Object(i.a)(n,2),c=(r[0],r[1]),o=Object(a.useState)(null),s=Object(i.a)(o,2),f=(s[0],s[1],Object(a.useState)(null)),d=Object(i.a)(f,2),b=d[0],j=d[1],m=function(){var e=Object(l.a)(u.a.mark((function e(){var n,r,a,o,i,s,l,f,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,r=k.getArchiveUrl(n),e.next=4,p.getImagesData(r);case 4:a=e.sent,o=k.parseArchiveData(a),i=o.sourceFiles,s=o.dir,l=o.server,f=i.filter((function(e){return"JPEG"==e.format})),d=f.map((function(e){return{img:"https://i0.wp.com/".concat(l).concat(s,"/").concat(e.name),thumb:"https://i0.wp.com/".concat(l).concat(s,"/").concat(e.name,"?w=320"),original:"https://".concat(l).concat(s,"/").concat(e.name)}})),console.log(d),j(d),console.log(i),c(a);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){m()}),[t]),b&&b.map((function(e){return Object(h.jsx)(D,{url:e.img,original:e.original,thumb:e.thumb,width:640,height:480},e.img)}))},B=["pix0x-57d723e9","pix0x-257ae802","2021-8-16-pix0x-d84c36573d37"],E=function(){var e=Object(a.useState)(B[0]),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(h.jsxs)("section",{children:[Object(h.jsx)(b,{onChange:function(e){console.log(e.target.value),r(e.target.value)},loadFirstSite:function(e){r(e[0])}}),Object(h.jsx)("div",{className:"ImageGallery",children:Object(h.jsx)(I,{selectedIdentifier:n})})]})};n(53),n(54);function C(){return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Lazy Load Images"}),Object(h.jsx)(E,{})]})}o.a.render(Object(h.jsx)(C,{}),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.9fc0abe9.chunk.js.map