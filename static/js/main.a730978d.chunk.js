(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var r,a=n(1),c=n(18),i=n.n(c),o=n(3),s=n(4),u=n.n(s),f=n(5),l=n(6),p=n.n(l),d={getImagesData:function(){var e=Object(f.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get(t);case 2:return n=e.sent,e.next=5,n.data;case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getIdentifierData:function(){var e=Object(f.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://archive.org/advancedsearch.php?q=creator%3Apix0x&fl%5B%5D=identifier&sort%5B%5D=publicdate+desc&sort%5B%5D=&sort%5B%5D=&rows=50&page=1&output=json&save=yes",e.next=3,p.a.get("https://archive.org/advancedsearch.php?q=creator%3Apix0x&fl%5B%5D=identifier&sort%5B%5D=publicdate+desc&sort%5B%5D=&sort%5B%5D=&rows=50&page=1&output=json&save=yes");case 3:return t=e.sent,e.next=6,t.data;case 6:return n=e.sent,e.abrupt("return",n.response.docs.map((function(e){return e.identifier})));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},h=n(0),b=function(e){var t=e.onChange,n=e.loadFirstSite,r=Object(a.useState)(null),c=Object(o.a)(r,2),i=(c[0],c[1],Object(a.useState)(null)),s=Object(o.a)(i,2),u=s[0],f=s[1];return Object(a.useEffect)((function(){d.getIdentifierData().then((function(e){f(e),n(e)}))}),[]),Object(h.jsx)("select",{onChange:t,className:"custom-select custom-select-lg",children:u&&u.map((function(e){return Object(h.jsx)("option",{value:e,children:e})}))})},g=n(8),j=n(9),m=n.n(j),v=new WeakMap;function O(e){e.forEach((function(e){if(v.has(e.target)){var t=v.get(e.target);(e.isIntersecting||e.intersectionRatio>0)&&(r.unobserve(e.target),v.delete(e.target),t())}}))}function x(){return void 0===r&&(r=new IntersectionObserver(O,{rootMargin:"100px",threshold:"0.15"})),r}n(43);var w=function(e){var t,n,r=e.url,c=e.thumb,i=(e.width,e.height,e.onImgError,Object(a.useState)(!1)),s=Object(o.a)(i,2),l=s[0],d=s[1],b=Object(a.useState)(!1),j=Object(o.a)(b,2),O=j[0],w=j[1],D=Object(a.useState)("inherit"),I=Object(o.a)(D,2),y=I[0],B=I[1],k=Object(a.useRef)();t=k,n=function(){w(!0)},Object(a.useEffect)((function(){var e=t.current,r=x();return v.set(e,n),r.observe(e),function(){v.delete(e),r.unobserve(e)}}),[]);var S=function(){var e=Object(f.a)(u.a.mark((function e(t,n){var r,a,c,i,o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(e,t){c.onload=function(){i.width=this.naturalWidth,i.height=this.naturalHeight,o.drawImage(this,0,0),i.toBlob((function(e){t(e)}),"image/png")},c.src=e,console.log(c)},a=function(){return(a=Object(f.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p.a.get(t,{responseType:"arraybuffer"}).then((function(e){return e.data})).then((function(e){return new Blob([e])})).then((function(e){return URL.createObjectURL(e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},r=function(e){return a.apply(this,arguments)},t.preventDefault(),c=new Image,i=document.createElement("canvas"),o=i.getContext("2d"),e.next=9,r(n).then((function(e){s(e,(function(e){console.log("doing it!"),navigator.clipboard.write([new ClipboardItem({"image/png":e})]).then((function(e){console.log("Image copied to clipboard")})).catch((function(e){console.log(e)}))}))}));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:"image-container",ref:k,style:{paddingBottom:"10px",minHeight:"240px",display:y},children:O&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:[Object(h.jsx)("img",{className:m()("image","thumb",Object(g.a)({},"isLoaded",!!l)),src:c}),Object(h.jsx)("img",{className:m()("image",Object(g.a)({},"isLoaded",!!l)),src:c,onLoad:function(){d(!0)},onError:function(){B("none")}})]}),Object(h.jsx)("button",{onClick:function(e){return S(e,r)},className:"btn-standard",children:"Copy Image"})]})})},D={getArchiveUrl:function(e){return"https://archive.org/metadata/".concat(e)},parseArchiveData:function(e){if(!e)return null;var t=e.files,n=e.metadata,r=e.server,a=e.dir;return{metadata:n,sourceFiles:t.filter((function(e){return"original"==e.source})),thumbs:t.map((function(e){return"derivative"===e.source&&"Thumbnail"===e.format})),server:r,dir:a}},getIdentifierCreator:function(e){return"https://archive.org/advancedsearch.php?q=creator%3Apix0x&fl%5B%5D=identifier&sort%5B%5D=publicdate+desc&sort%5B%5D=&sort%5B%5D=&rows=50&page=1&output=json&callback=callback&save=yes"}},I=function(e){var t=e.selectedIdentifier,n=Object(a.useState)(null),r=Object(o.a)(n,2),c=(r[0],r[1]),i=Object(a.useState)(null),s=Object(o.a)(i,2),l=(s[0],s[1],Object(a.useState)(null)),p=Object(o.a)(l,2),b=p[0],g=p[1],j=function(){var e=Object(f.a)(u.a.mark((function e(){var n,r,a,i,o,s,f,l,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,r=D.getArchiveUrl(n),e.next=4,d.getImagesData(r);case 4:a=e.sent,i=D.parseArchiveData(a),o=i.sourceFiles,s=i.dir,f=i.server,l=o.filter((function(e){return"JPEG"==e.format})),p=l.map((function(e){return{img:"https://i0.wp.com/".concat(f,"/").concat(s,"/").concat(e.name),thumb:"https://i0.wp.com/".concat(f,"/").concat(s,"/").concat(e.name,"?w=320")}})),console.log(p),g(p),console.log(o),c(a);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){j()}),[t]),b&&b.map((function(e){return Object(h.jsx)(w,{url:e.img,thumb:e.thumb,width:640,height:480},e.img)}))},y=["pix0x-57d723e9","pix0x-257ae802","2021-8-16-pix0x-d84c36573d37"],B=function(){var e=Object(a.useState)(y[0]),t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(h.jsxs)("section",{children:[Object(h.jsx)(b,{onChange:function(e){console.log(e.target.value),r(e.target.value)},loadFirstSite:function(e){r(e[0])}}),Object(h.jsx)("div",{className:"ImageGallery",children:Object(h.jsx)(I,{selectedIdentifier:n})})]})};n(44),n(45);function k(){return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Lazy Load Images"}),Object(h.jsx)(B,{})]})}i.a.render(Object(h.jsx)(k,{}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.a730978d.chunk.js.map